# DB Connector - Инструкция по установке на Windows 10

Подробная инструкция по установке и запуску DB Connector на Windows 10.

## Системные требования

- Windows 10 (версия 1809 или новее)
- Права администратора для установки программного обеспечения
- Минимум 4 ГБ оперативной памяти
- 2 ГБ свободного места на диске

## Шаг 1: Установка Python

1. **Скачайте Python**:
   - Перейдите на официальный сайт: https://www.python.org/downloads/
   - Скачайте последнюю версию Python 3.9 или выше (рекомендуется Python 3.11 или 3.12)

2. **Установите Python**:
   - Запустите скачанный установщик
   - ⚠️ **ВАЖНО**: Обязательно отметьте галочку "Add Python to PATH" внизу окна установщика
   - Нажмите "Install Now"
   - Дождитесь завершения установки

3. **Проверьте установку**:
   - Откройте командную строку (нажмите `Win + R`, введите `cmd`, нажмите Enter)
   - Выполните команду:
   ```cmd
   python --version
   ```
   - Вы должны увидеть версию Python, например: `Python 3.11.5`

## Шаг 2: Установка Node.js

1. **Скачайте Node.js**:
   - Перейдите на официальный сайт: https://nodejs.org/
   - Скачайте LTS версию (версия 18 или выше)

2. **Установите Node.js**:
   - Запустите скачанный установщик
   - Следуйте инструкциям мастера установки
   - Оставьте все настройки по умолчанию
   - Дождитесь завершения установки

3. **Проверьте установку**:
   - Откройте **новую** командную строку (закройте старую, если была открыта)
   - Выполните команды:
   ```cmd
   node --version
   npm --version
   ```
   - Вы должны увидеть версии Node.js и npm

## Шаг 3: Установка Git (опционально, но рекомендуется)

1. **Скачайте Git**:
   - Перейдите на: https://git-scm.com/download/win
   - Скачайте установщик

2. **Установите Git**:
   - Запустите установщик
   - Используйте настройки по умолчанию
   - Нажимайте "Next" до завершения установки

3. **Проверьте установку**:
   ```cmd
   git --version
   ```

## Шаг 4: Скачивание проекта

### Вариант A: С использованием Git (рекомендуется)

```cmd
git clone https://github.com/ideav/connector.git
cd connector
```

### Вариант B: Скачивание ZIP-архива

1. Перейдите на: https://github.com/ideav/connector
2. Нажмите зеленую кнопку "Code"
3. Выберите "Download ZIP"
4. Распакуйте архив в удобное место
5. Откройте командную строку и перейдите в папку проекта:
```cmd
cd C:\путь\к\папке\connector
```

## Шаг 5: Настройка и запуск Backend (серверная часть)

1. **Перейдите в папку backend**:
```cmd
cd backend
```

2. **Создайте виртуальное окружение Python**:
```cmd
python -m venv venv
```

3. **Активируйте виртуальное окружение**:
```cmd
venv\Scripts\activate
```
После активации вы увидите `(venv)` в начале строки командной строки.

4. **Установите зависимости**:
```cmd
pip install -r requirements.txt
```
Этот процесс может занять несколько минут.

5. **Запустите сервер**:
```cmd
uvicorn app.main:app --reload --host 0.0.0.0 --port 8000
```

6. **Проверьте работу**:
   - Сервер запущен, если вы видите сообщение: `Application startup complete`
   - Откройте браузер и перейдите на: http://localhost:8000/docs
   - Вы должны увидеть документацию API (Swagger UI)

⚠️ **Оставьте это окно командной строки открытым** - сервер работает в нём.

## Шаг 6: Настройка и запуск Frontend (клиентская часть)

1. **Откройте НОВОЕ окно командной строки** (не закрывайте предыдущее!)

2. **Перейдите в папку проекта и затем в frontend**:
```cmd
cd C:\путь\к\папке\connector\frontend
```

3. **Установите зависимости**:
```cmd
npm install
```
Этот процесс может занять несколько минут.

4. **Запустите приложение**:
```cmd
npm run dev
```

5. **Откройте приложение**:
   - После запуска вы увидите адрес (обычно http://localhost:5173 или http://localhost:3000)
   - Откройте этот адрес в браузере
   - Вы должны увидеть интерфейс DB Connector

⚠️ **Оставьте это окно командной строки также открытым** - приложение работает в нём.

## Шаг 7: Установка драйверов баз данных (при необходимости)

### MySQL
Драйвер уже установлен в requirements.txt, дополнительных действий не требуется.

### PostgreSQL
Драйвер уже установлен в requirements.txt, дополнительных действий не требуется.

### MS SQL Server

1. **Установите Microsoft ODBC Driver 17 for SQL Server**:
   - Перейдите на: https://docs.microsoft.com/en-us/sql/connect/odbc/download-odbc-driver-for-sql-server
   - Скачайте "ODBC Driver 17 for SQL Server" для Windows
   - Запустите установщик и следуйте инструкциям

2. **Проверьте установку**:
   - Откройте "Администратор источников данных ODBC" (ODBC Data Sources)
   - Перейдите на вкладку "Драйверы" (Drivers)
   - Убедитесь, что в списке есть "ODBC Driver 17 for SQL Server"

### Oracle

1. **Скачайте Oracle Instant Client**:
   - Перейдите на: https://www.oracle.com/database/technologies/instant-client/winx64-64-downloads.html
   - Скачайте "Basic Package" (ZIP-файл)

2. **Установите Oracle Instant Client**:
   - Создайте папку, например: `C:\oracle\instantclient_19_21`
   - Распакуйте содержимое ZIP-архива в эту папку

3. **Настройте переменные окружения**:
   - Нажмите `Win + Pause/Break` или найдите "Система" в Панели управления
   - Нажмите "Дополнительные параметры системы"
   - Нажмите "Переменные среды"
   - В разделе "Системные переменные" найдите переменную `Path` и нажмите "Изменить"
   - Нажмите "Создать" и добавьте путь к папке Oracle Instant Client (например: `C:\oracle\instantclient_19_21`)
   - Нажмите "ОК" во всех окнах

4. **Перезапустите командную строку** и повторите запуск backend для применения изменений.

## Использование приложения

После успешного запуска обеих частей (backend и frontend):

1. Откройте браузер и перейдите на адрес frontend (обычно http://localhost:5173)
2. В интерфейсе приложения заполните параметры подключения к вашей базе данных
3. Нажмите "Connect" для подключения
4. Используйте дерево навигации для просмотра структуры БД
5. Пишите и выполняйте SQL-запросы
6. Экспортируйте результаты в формат TAB-delimited для использования в Excel или Intagram

Подробнее см. в файле [USAGE.md](USAGE.md).

## Остановка приложения

Для остановки приложения:
1. Перейдите в окно командной строки, где запущен frontend
2. Нажмите `Ctrl + C`
3. Перейдите в окно командной строки, где запущен backend
4. Нажмите `Ctrl + C`

## Повторный запуск приложения

После остановки, для повторного запуска:

### Backend
```cmd
cd C:\путь\к\папке\connector\backend
venv\Scripts\activate
uvicorn app.main:app --reload --host 0.0.0.0 --port 8000
```

### Frontend (в новом окне командной строки)
```cmd
cd C:\путь\к\папке\connector\frontend
npm run dev
```

## Распространенные проблемы и решения

### Проблема: "Python не найден" или "'python' не является внутренней командой"

**Решение**:
1. Убедитесь, что при установке Python вы отметили галочку "Add Python to PATH"
2. Если не отметили, переустановите Python или добавьте его в PATH вручную:
   - Найдите папку установки Python (обычно `C:\Users\ВашеИмя\AppData\Local\Programs\Python\Python311`)
   - Добавьте эту папку и подпапку `Scripts` в переменную окружения PATH

### Проблема: "pip не найден" или "'pip' не является внутренней командой"

**Решение**:
```cmd
python -m pip install --upgrade pip
```

### Проблема: Ошибка при установке psycopg2-binary или других пакетов

**Решение**:
1. Убедитесь, что у вас установлен Microsoft Visual C++ Redistributable:
   - Скачайте с: https://learn.microsoft.com/en-us/cpp/windows/latest-supported-vc-redist
   - Установите обе версии (x64 и x86)
2. Попробуйте установить пакеты заново:
```cmd
pip install --upgrade pip setuptools wheel
pip install -r requirements.txt
```

### Проблема: Порт 8000 или 5173 уже используется

**Решение**:
1. Найдите процесс, использующий порт:
```cmd
netstat -ano | findstr :8000
```
2. Завершите процесс по PID:
```cmd
taskkill /PID номер_процесса /F
```
3. Или запустите сервер на другом порту:
```cmd
uvicorn app.main:app --reload --port 8001
```

### Проблема: npm install выдает ошибки

**Решение**:
1. Очистите кэш npm:
```cmd
npm cache clean --force
```
2. Удалите папку `node_modules` и файл `package-lock.json`:
```cmd
rmdir /s /q node_modules
del package-lock.json
```
3. Установите пакеты заново:
```cmd
npm install
```

### Проблема: Не удается подключиться к базе данных

**Решение**:
1. Убедитесь, что сервер БД запущен
2. Проверьте правильность параметров подключения (хост, порт, имя БД, пользователь, пароль)
3. Убедитесь, что файрвол Windows не блокирует соединение
4. Для SQL Server: убедитесь, что включен TCP/IP протокол в SQL Server Configuration Manager
5. Для удаленных БД: проверьте, что сервер БД настроен на прием внешних подключений

### Проблема: Backend запускается, но выдает ошибки импорта

**Решение**:
1. Убедитесь, что виртуальное окружение активировано (в начале строки должно быть `(venv)`)
2. Переустановите зависимости:
```cmd
pip install --force-reinstall -r requirements.txt
```

### Проблема: Frontend показывает белый экран

**Решение**:
1. Откройте консоль разработчика в браузере (F12)
2. Проверьте ошибки в консоли
3. Убедитесь, что backend запущен и доступен по адресу http://localhost:8000
4. Проверьте, что в файле `frontend/vite.config.ts` правильно настроен прокси

### Проблема: Ошибка "Access Denied" при установке пакетов

**Решение**:
1. Запустите командную строку от имени администратора:
   - Нажмите `Win`, введите `cmd`
   - Нажмите правой кнопкой мыши на "Командная строка"
   - Выберите "Запуск от имени администратора"
2. Повторите команды установки

## Дополнительные рекомендации

### Использование PowerShell вместо cmd

Вы можете использовать PowerShell вместо командной строки. Основные отличия:
- Для активации виртуального окружения используйте:
```powershell
venv\Scripts\Activate.ps1
```
- Если возникает ошибка "Execution of scripts is disabled", выполните:
```powershell
Set-ExecutionPolicy -ExecutionPolicy RemoteSigned -Scope CurrentUser
```

### Настройка IDE (опционально)

Для разработки рекомендуется использовать:
- **Visual Studio Code**: https://code.visualstudio.com/
  - Установите расширения: Python, ESLint, Prettier
- **PyCharm Community**: https://www.jetbrains.com/pycharm/download/ (для Python)
- **WebStorm**: https://www.jetbrains.com/webstorm/download/ (для frontend)

### Автозапуск (опционально)

Для удобства можно создать BAT-файлы для запуска:

**start-backend.bat**:
```bat
@echo off
cd /d "%~dp0backend"
call venv\Scripts\activate
uvicorn app.main:app --reload --host 0.0.0.0 --port 8000
pause
```

**start-frontend.bat**:
```bat
@echo off
cd /d "%~dp0frontend"
npm run dev
pause
```

Сохраните эти файлы в корневой папке проекта и запускайте двойным щелчком.

## Обновление проекта

Если вы клонировали проект через Git:

```cmd
cd C:\путь\к\папке\connector
git pull
cd backend
venv\Scripts\activate
pip install -r requirements.txt
cd ..\frontend
npm install
```

## Справка и поддержка

- Документация API: http://localhost:8000/docs (когда backend запущен)
- Основной README: [README.md](README.md)
- Руководство по использованию: [USAGE.md](USAGE.md)
- Общая инструкция по установке: [SETUP.md](SETUP.md)

## Полезные ссылки

- Python: https://www.python.org/
- Node.js: https://nodejs.org/
- FastAPI документация: https://fastapi.tiangolo.com/
- React документация: https://react.dev/
- Vite документация: https://vitejs.dev/

---

Если у вас возникли проблемы, не описанные в этой инструкции, создайте issue в репозитории проекта: https://github.com/ideav/connector/issues
